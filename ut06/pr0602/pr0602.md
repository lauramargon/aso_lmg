```
---------------- ADMINISTRACIÓN DE SISTEMAS INFORMÁTICOS Y REDES ----------------
---------------------------------------------------------------------------------

Módulo:                     ADMINISTRACIÓN DE SISTEMAS OPERATIVOS
Profesor:                   Víctor J. González
Unidad de Trabajo:          UT06
Práctica:                   PR0602. El pipeline en Powershell
Resultados de aprendizaje:  RA7
```

# PR0602: El pipeline en Powershell

Realiza las siguientes tareas que se te piden utilizando **Powershell**. Para contestar lo mejor es que hagas una captura de pantalla donde se vea el comando que has introducido y las primeras líneas de la salida de este.

1. El comando `Get-Date` muestra la fecha y hora actual. Muestra por pantalla únicamente el año en que estamos.

```bash
PS C:\Users\Administrador> (Get-Date).Year
2025

```
2. Uno de los requisitos de Windows 11 es que es procesador tenga **TPM** habilitado. Powershell dispone del comando `Get-TPM` que nos muestra información sobre este módulo. Muestra por pantalla, en formato tabla, las propiedades `TpmPresent`, `TpmReady`, `TpmEnabled` y `TpmActivated`.

```bash
PS C:\Users\Administrador> Get-TPM | Select-Object TpmPresent, TpmReady, TpmEnabled, TpmActivated

TpmPresent TpmReady TpmEnabled TpmActivated
---------- -------- ---------- ------------
     False    False      False        False

```

En los siguientes ejercicios trabajaremos con los ficheros devueltos por el comando `Get-ChildItem C:\Windows\System32`.

3. Muestra por pantalla el número de ficheros y directorios que hay en ese directorio.

```bash
PS C:\Users\Administrador> (Get-ChildItem C:\Windows\System32 | Measure-Object).Count
4478

```

4. Los objetos devueltos por el comando anterior tienen una propiedad denominada `Extension`, que indica la extensión del archivo. Calcula el número de ficheros en el directorio que tienen la extensión `.dll`.

```bash
PS C:\Users\Administrador> (Get-ChildItem C:\Windows\System32 | Where-Object Extension -eq ".dll").Count
3251

```

5. Muestra los ficheros del directorio con extensión `.exe` que tengan un tamaño superior a 50000 bytes.

```bash
PS C:\Users\Administrador> Get-ChildItem C:\Windows\System32 -File | Where-Object {($_.Extension -eq ".exe") -and ($_.Length -gt 50000)}


    Directorio: C:\Windows\System32


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
-a----        06/09/2024      6:12         884736 AgentService.exe
-a----        06/09/2024      6:13         315392 AggregatorHost.exe
-a----        06/09/2024      6:12        3253704 aitstatic.exe
-a----        06/09/2024      6:12         188416 alg.exe
-a----        06/09/2024      6:13         139264 AppHostRegistrationVerifier.exe
-a----        01/04/2024      9:00         155648 appidpolicyconverter.exe
-a----        06/09/2024      6:12          62880 AppInstallerBackgroundUpdate.exe
-a----        06/09/2024      6:13          96528 ApplicationFrameHost.exe
-a----        06/09/2024      6:12         819200 ApplySettingsTemplateCatalog.exe
-a----        06/09/2024      6:12        1265904 ApplyTrustOffline.exe
-a----        06/09/2024      6:12         791896 AppVClient.exe
-a----        06/09/2024      6:12         193856 AppVDllSurrogate.exe
-a----        06/09/2024      6:12         185760 AppVNice.exe
-a----        06/09/2024      6:12         234912 AppVShNotify.exe
-a----        06/09/2024      6:12         151552 AtBroker.exe
-a----        06/09/2024      6:12         881608 audiodg.exe
-a----        01/04/2024      9:00          61440 auditpol.exe
-a----        01/04/2024     18:32         158376 AuthHost.exe

```

6. Muestra los ficheros de este directorio que tengan extensión `.dll`, ordenados por fecha de creación y mostrando únicamente las propiedades de fecha de creación (`CreationTime`), último acceso (`LastAccessTime`) y nombre (`Name`).

```bash
PS C:\Users\Administrador> Get-ChildItem C:\Windows\System32 -File | Where-Object {$_.Extension -eq ".dll"} | Sort-Object CreationTime | Select-Object CreationTime, LastAccessTime, Name

CreationTime        LastAccessTime      Name
------------        --------------      ----
01/04/2024 9:00:23  01/04/2024 9:00:23  EtwRundown.dll
01/04/2024 9:00:23  01/04/2024 9:00:23  pcwum.dll
01/04/2024 9:00:23  01/04/2024 9:00:23  hal.dll
01/04/2024 9:00:23  01/04/2024 9:00:23  BOOTVID.DLL
01/04/2024 9:00:23  01/04/2024 9:00:23  mcupdate_GenuineIntel.dll
01/04/2024 9:00:23  01/04/2024 9:00:23  devrtl.dll
01/04/2024 9:00:23  01/04/2024 9:00:23  mcupdate_AuthenticAMD.dll
01/04/2024 9:00:23  01/04/2024 9:00:23  plutonfw_AuthenticAMD.dll
01/04/2024 9:00:23  01/04/2024 9:00:23  dabapi.dll
01/04/2024 9:00:23  01/04/2024 9:00:23  dbgeng.dll
01/04/2024 9:00:23  01/04/2024 9:00:23  advapi32res.dll
01/04/2024 9:00:23  01/04/2024 9:00:23  credssp.dll
01/04/2024 9:00:23  01/04/2024 9:00:23  KBDUS.DLL
01/04/2024 9:00:23  01/04/2024 9:00:23  cryptbase.dll
01/04/2024 9:00:23  01/04/2024 9:00:23  uexfat.dll
01/04/2024 9:00:23  01/04/2024 9:00:23  ufat.dll
01/04/2024 9:00:23  01/04/2024 9:00:23  msaudite.dll
01/04/2024 9:00:23  01/04/2024 9:00:23  kd.dll

```

7. Muestra el tamaño (`Length`) y nombre completo (`FullName`) de todos los ficheros del directorio ordenados por tamaño en sentido descendente.

```bash

PS C:\Users\Administrador> Get-ChildItem C:\Windows\System32 -File | Select-Object Length, FullName | Sort-Object Length -Descending

  Length FullName
  ------ --------
41943040 C:\Windows\System32\ntds.dit
25980928 C:\Windows\System32\edgehtml.dll
24035328 C:\Windows\System32\mshtml.dll
17874944 C:\Windows\System32\Windows.UI.Xaml.dll
12723640 C:\Windows\System32\ntoskrnl.exe
11900896 C:\Windows\System32\VBoxGL.dll
10577464 C:\Windows\System32\onnxruntime.dll
10563584 C:\Windows\System32\wmp.dll
 9904128 C:\Windows\System32\NlsLexicons000a.dll
 9691136 C:\Windows\System32\NlsData000a.dll
 9158656 C:\Windows\System32\mstscax.dll
 9097216 C:\Windows\System32\twinui.pcshell.dll
 8620760 C:\Windows\System32\windows.storage.dll
 8118272 C:\Windows\System32\BingMaps.dll
 7938048 C:\Windows\System32\Chakra.dll
 7492824 C:\Windows\System32\Windows.Media.Protection.PlayReady.dll
 7462912 C:\Windows\System32\ieframe.dll
 7344056 C:\Windows\System32\shell32.dll
 7225344 C:\Windows\System32\dbgeng.dll
 6877048 C:\Windows\System32\Windows.Media.dll

```

8. Muestra el tamaño y nombre completo de todos los ficheros del directorio que tengan un tamaño superior a 10MB (10000000 bytes) ordenados por tamaño.

```bash
PS C:\Users\Administrador> Get-ChildItem C:\Windows\System32 -File | Where-Object { $_.Length -gt 10000000 } | Sort-Object Length | Select-Object Length, FullName

  Length FullName
  ------ --------
10563584 C:\Windows\System32\wmp.dll
10577464 C:\Windows\System32\onnxruntime.dll
11900896 C:\Windows\System32\VBoxGL.dll
12723640 C:\Windows\System32\ntoskrnl.exe
17874944 C:\Windows\System32\Windows.UI.Xaml.dll
24035328 C:\Windows\System32\mshtml.dll
25980928 C:\Windows\System32\edgehtml.dll
41943040 C:\Windows\System32\ntds.dit

```

9.  Muestra el tamaño y nombre completo de todos los ficheros del directorio que tengan un tamaño superior a 10MB y extensión `.exe` ordenados por tamaño.

```bash
PS C:\Users\Administrador> Get-ChildItem C:\Windows\System32 -File | Where-Object { $_.Extension -eq ".exe" -and $_.Length -gt 10000000 } | Sort-Object Length | Select-Object Length, FullName

  Length FullName
  ------ --------
12723640 C:\Windows\System32\ntoskrnl.exe

```

Teniendo en cuenta lo anterior, realiza los siguientes ejercicios:

1.  Muestra todos los procesos que tienen el estado `Responding` puesto a `False`, es decir, todos los procesos del sistema que se hayan colgado.

```bash
PS C:\Users\Administrador> Get-Process | Where-Object Responding -eq $False

```

11. Muestra todos los ficheros de `C:\Windows` que hayan sido creados con fecha posterior al 15 de octubre de este año.

```bash
PS C:\Users\Administrador> Get-ChildItem C:\Windows -File | Where-Object {$_.CreationTime -gt '2025-10-15'}


    Directorio: C:\Windows


Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
-a----        27/11/2025     12:21            770 PFRO.log

```