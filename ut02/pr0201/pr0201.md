# PR0201: Usuarios y permisos en Linux
## 1. Permisos de usuarios
### 1.	Crea el directorio `pr0201` dentro de tu directorio personal y dentro de él crea los directorios `dir1` y `dir2` ¿Cuáles son los permisos del directorio `dir1`? No pongas una captura, explica quiénes tienen permisos sobre el directorio y qué pueden hacer en él.
![](imagenes/0201.1.png)  
**usuario->** lectura, escritura, ejecución  
**grupo->** lectura, escritura y ejecución  
**otros->** lectura y ejecución

![](imagenes/0201.1.1.png)
### 2.	Utilizando   la   notación   simbólica, elimina   todos   los   permisos de   escritura (propietario, grupo, otros) del directorio `dir2`.
![](imagenes/0201.2.png)

### 3.	Utilizando la notación octal, elimina el permiso de lectura del directorio `dir2`, al resto de los usuarios.

![](imagenes/0201.3.png)
### 4.¿Cuáles son ahora los permisos asociados a `dir2`?

`r-xr-x--x`  

usuario-> lectura y ejecución  

grupo-> lectura y ejecución  

otros-> ejecución  

### 5.	Crear bajo `dir2`, un directorio llamado `dir21`.

![](imagenes/0201.4.png)

Falla porque le hemos quitado el permiso de escritura 
### 6.	Concédete a ti mismo permiso de escritura en el directorio `dir2` e intenta de nuevo el paso anterior.
![](imagenes/0201.6.png)
Al proporcionarle al dir2 permiso de escritura ya nos permite crear el dir21 dentro de dir2 
## 2. Notación Octal y simbólica
### 1. Supón que el fichero ~/file tiene los permisos rw-r--r--. Escribe el comando o comandos que necesitarías para establecer los siguientes permisos en el fichero anterior utilizando notación simbólica.

 
1. rwxrwxr-x (usuario y grupo rwx, otros r-x) 

    `chmod u=rwx,g=rwx,o=rx ~/file`
 
2. rwxr--r-- (usuario rwx, grupo r, otros r)

    `chmod u=rwx,g=r,o=r ~/file`

3. r--r----- (usuario r, grupo r, otros nada) 

    `chmod u=r,g=r,o= ~/file`
 
4. rwxr-xr-x (usuario rwx, grupo r-x, otros r-x) 

    `hmod u=rwx,g=rx,o=rx ~/file `
 
5. rwxr-xr-x (repetido, mismo que anterior) 

    `chmod u=rwx,g=rx,o=rx ~/file`

6. r-x--x--x (usuario r-x, grupo --x, otros --x) 

    `chmod u=rx,g=x,o=x ~/file`
 
7. -w-r----x (usuario -w-, grupo r--, otros --x) 

    `chmod u=w,g=r,o=x ~/file `

8. -----xrwx (usuario nada, grupo --x, otros rwx) 

    `chmod u=,g=x,o=rwx ~/file `
 
9. r---w---x (usuario r--, grupo -w-, otros --x) 

    `chmod u=r,g=w,o=x ~/file `
 
10. -w------- (usuario -w-, grupo nada, otros nada) 

    `chmod u=w,g=,o= ~/file `
 
11. rw-r----- (usuario rw-, grupo r--, otros nada) 

    `chmod u=rw,g=r,o= ~/file`
 
12. rwx--x--x (usuario rwx, grupo --x, otros --x) 

    `chmod u=rwx,g=x,o=x ~/file `
# 3 El bit setgid

## 3.1 Crea un grupo llamado asir y los usuarios {iniciales}1 e {iniciales}2, donde {iniciales} son las iniciales de tu nombre. Por ejemplo, en mi caso se llamarían vjgr1 y vjgr2. Haz que los usuarios pertenezcan al grupo.

```bash
laura@lmg-server:~$ sudo groupadd asir
laura@lmg-server:~$ sudo useradd  -G asir lmg1
laura@lmg-server:~$ sudo useradd  -G asir lmg2
```
## 3.2 Crea el directorio /compartido y asigna propietario: root como usuario propietario y asir como grupo propietario.

```bash
sudo mkdir /compartido
sudo chown root:asir /compartido
```
## 3.3 Asigna al directorio creado permisos de lectura, escritura y ejecución para el usuario y el grupo propietario. El resto de usuarios no tendrá ningún tipo de permiso.

```bash
sudo chmod 770 /compratido
```
## 3.4 Establece el bit setgid en el directorio y verifica que se haya asignado.

```bash
sudo chmod g+s /compartido
ls -ld /compartido
```
## 3.5 Inicia sesión con usuario1, accede al directorio y crea un fichero llamado fichero1 con algo de contenido. Comprueba los permisos del fichero que has creado.

```bash

laura@lmg-server:~$ su lmg1

Password: 
$ cd /compartido
$ touch fichero1    
$ echo "esto contiene el fichero1" > fichero1
$ ls -l /compartido/fichero1

-rw-rw-r-- 1 lmg1 asir 26 Oct  7 10:19 /compartido/fichero1///////////////////////////////////////////////////////////////////////
```
## 3.6 Ahora inicia sesión con usuario2 y comprueba si puedes acceder a /compartido/fichero1 y si puedes añadirle contenido.

```bash
$ cat fichero1
esto contiene el fichero1
$ su lmg2

Password:
$ cd /compartido
$ echo "esto lo añadio el 2" >fichero1
$ cat fichero1
esto lo añadio el 2
```
## 3.7 Responde las siguientes preguntas:
### 3.7.1 ¿Qué ventajas tiene usar el bit setgid en entornos colaborativos?
El bit setgid asegura que cualquier archivo o subdirectorio creado dentro de un directorio here el grupo propietario del directorio, en lugar del grupo predeterminado del usuario que crea el archivo. Esto es útil en entornos colaborativos porque garantiza que todos los archivos creados dentro de un directorio compartido pertenezcan al grupo del directorio, facilitando la colaboración sin que sea necesario modificar los permisos o grupos manualmente cada vez que se crea un archivo.
### 3.7.2 ¿Qué sucede si no se aplica el bit setgid en un entorno colaborativo?
Si el bit setgid no está activo, los archivos y subdirectorios que se generen en el directorio tomarán el grupo del usuario que los crea. Esto puede generar complicaciones en entornos donde se colabora, ya que otros miembros del grupo original tal vez no cuenten con los permisos adecuados para entrar o cambiar esos archivos, lo que podría entorpecer el trabajo conjunto y necesitar cambios manuales en los permisos o grupos de los archivos.
## 3.8 Cuando hayas acabado, limpia el sistema eliminando los usuarios y el directorio creado para la práctica.
```bash
laura@lmg-server:~$ sudo userdel  lmg1
laura@lmg-server:~$ sudo userdel  lmg2
laura@lmg-server:~$ sudo rm -r  /compartido
```
# 4 El sticky bit
## 4.1 Crea el directorio /compartido con todos los permisos para todos los usuarios.
```bash
sudo mkdir /compartido
sudo chmod 777 /compartido
```
## 4.2 Crea dos usuarios {iniciales}1 e {iniciales}2
```bash
laura@lmg-server:~$ sudo useradd -m lmg1
laura@lmg-server:~$ sudo useradd -m lmg2
laura@lmg-server:~$ sudo passwd lmg1
laura@lmg-server:~$ sudo passwd lmg2
```
## 4.3 Vamos a probar primero el funcionamiento sin el sticky bit. Inicia sesión con el primer usuario, crea un fichero y luego, con el segundo usuario, intenta eliminarlo.
```bash
laura@lmg-server:~$ su lmg1
Password: 
$ touch /compartido/fichero1.txt
$ exit
laura@lmg-server:~$ su lmg2

Password: 
$ rm /compartido/fichero1.txt
rm: remove write-protected regular empty file '/compartido/fichero1.txt'?
```
## 4.4 Ahora establece el sticky bit en el directorio y verifica que se ve en los permisos.
```bash

laura@lmg-server:~$ sudo chmod +t /compartido
laura@lmg-server:~$ ls -ld /compartido
drwxrwxrwt 2 root root 4096 Oct  15 09:55 /compartido
```
## 4.5 Vuelve a iniciar sesión con el primer usuario, crea un fichero e intenta eliminarlo con el segundo usuario.

```bash
laura@lmg-server:~$ su lmg1
Password: 
$ touch /compartido/archivo2.txt
$ exit
laura@lmg-server:~$ su lmg2



Password: 
$ rm /compartido/archivo2.txt
rm: remove write-protected regular empty file '/compartido/archivo2.txt'? y
rm: cannot remove '/compartido/archivo2.txt': Operation not permitted
```
## 4.6 Responde las siguientes preguntas:
### 4.6.1 ¿Qué efecto tiene el sticky bit en un directorio?
El sticky bit en un directorio impide que se borren o cambien de nombre archivos en ese directorio. En concreto, solo el dueño del archivo (o el usuario root) tiene la capacidad de eliminar o renombrar archivos en un directorio que tiene sticky bit, aun cuando otros usuarios cuenten con permisos de escritura en ese directorio.
### 4.6.2 Si tienes habilitado el sticky bit, ¿cómo tendrías que hacer para eliminar un fichero dentro del directorio?
El propietario del fichero.
O tener privilegios de superusuario (root).


[Volver](../../index.md)

